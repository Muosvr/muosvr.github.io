import{S as e,i as t,s as a,e as s,c as o,a as l,d as r,b as n,f as c,n as i,t as d,g as u,h as f,j as h,k as p,l as g,m,z as v,r as $,G as b,o as k,p as E,q as P,M as x,v as I,w as T,x as y,H as w,u as B,L as N,I as U,B as L,K as D,N as S,O,A,P as V,C as j,D as H}from"./client.65f83058.js";import{u as M,b as q,c as R,g as z,s as C,d as F,e as W}from"./index.02369f4d.js";import"./v4.96b22442.js";import{s as G,a as K,d as J,b as Q,c as X,e as Y,f as Z,g as _,h as ee,i as te,j as ae,k as se,l as oe,m as le,t as re,n as ne,o as ce,p as ie,B as de,q as ue}from"./Block.8e58f4c0.js";function fe(e){let t,a,i,$,b,k,E,P,x,I,T;return{c(){t=s("span"),a=d(e[0]),i=u(),$=s("div"),b=s("button"),k=d("Edit"),E=u(),P=s("button"),x=d("Delete"),this.h()},l(s){t=o(s,"SPAN",{});var n=l(t);a=f(n,e[0]),n.forEach(r),i=h(s),$=o(s,"DIV",{class:!0});var c=l($);b=o(c,"BUTTON",{class:!0});var d=l(b);k=f(d,"Edit"),d.forEach(r),E=h(c),P=o(c,"BUTTON",{class:!0});var u=l(P);x=f(u,"Delete"),u.forEach(r),c.forEach(r),this.h()},h(){n(b,"class","svelte-1x1bio2"),n(P,"class","svelte-1x1bio2"),n($,"class","button-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,$,o),p($,b),p(b,k),p($,E),p($,P),p(P,x),I||(T=[g(b,"click",e[9]),g(P,"click",e[10])],I=!0)},p(e,t){1&t&&m(a,e[0])},d(e){e&&r(t),e&&r(i),e&&r($),I=!1,v(T)}}}function he(e){let t,a,i,m,b,k,E,P,x,I,T,y,w,B,N,U,L,D,S;return{c(){t=s("div"),a=s("label"),i=d("Name"),b=u(),k=s("input"),P=u(),x=s("label"),I=d("Link"),y=u(),w=s("input"),N=u(),U=s("button"),L=d("Done"),this.h()},l(e){t=o(e,"DIV",{class:!0});var s=l(t);a=o(s,"LABEL",{for:!0});var n=l(a);i=f(n,"Name"),n.forEach(r),b=h(s),k=o(s,"INPUT",{id:!0,class:!0}),P=h(s),x=o(s,"LABEL",{for:!0});var c=l(x);I=f(c,"Link"),c.forEach(r),y=h(s),w=o(s,"INPUT",{id:!0,class:!0}),N=h(s),U=o(s,"BUTTON",{class:!0});var d=l(U);L=f(d,"Done"),d.forEach(r),s.forEach(r),this.h()},h(){n(a,"for",m="item-text-"+e[2]),n(k,"id",E="item-text-"+e[2]),n(k,"class","svelte-1x1bio2"),n(x,"for",T="item-href-"+e[2]),n(w,"id",B="item-href-"+e[2]),n(w,"class","svelte-1x1bio2"),n(U,"class","svelte-1x1bio2"),n(t,"class","edit-panel svelte-1x1bio2")},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,b),p(t,k),$(k,e[0]),p(t,P),p(t,x),p(x,I),p(t,y),p(t,w),$(w,e[1]),p(t,N),p(t,U),p(U,L),D||(S=[g(k,"input",e[6]),g(w,"input",e[7]),g(U,"click",e[8])],D=!0)},p(e,t){4&t&&m!==(m="item-text-"+e[2])&&n(a,"for",m),4&t&&E!==(E="item-text-"+e[2])&&n(k,"id",E),1&t&&k.value!==e[0]&&$(k,e[0]),4&t&&T!==(T="item-href-"+e[2])&&n(x,"for",T),4&t&&B!==(B="item-href-"+e[2])&&n(w,"id",B),2&t&&w.value!==e[1]&&$(w,e[1])},d(e){e&&r(t),D=!1,v(S)}}}function pe(e){let t;function a(e,t){return e[5]?he:fe}let d=a(e),u=d(e);return{c(){t=s("div"),u.c(),this.h()},l(e){t=o(e,"DIV",{class:!0});var a=l(t);u.l(a),a.forEach(r),this.h()},h(){n(t,"class","item-container svelte-1x1bio2")},m(e,a){c(e,t,a),u.m(t,null)},p(e,[s]){d===(d=a(e))&&u?u.p(e,s):(u.d(1),u=d(e),u&&(u.c(),u.m(t,null)))},i:i,o:i,d(e){e&&r(t),u.d()}}}function ge(e,t,a){let s=!1,{text:o}=t,{href:l}=t,{index:r}=t,{handleDelete:n}=t,{handleUpdate:c}=t;return e.$$set=e=>{"text"in e&&a(0,o=e.text),"href"in e&&a(1,l=e.href),"index"in e&&a(2,r=e.index),"handleDelete"in e&&a(3,n=e.handleDelete),"handleUpdate"in e&&a(4,c=e.handleUpdate)},[o,l,r,n,c,s,function(){o=this.value,a(0,o)},function(){l=this.value,a(1,l)},()=>{a(5,s=!1),c()},()=>a(5,s=!0),()=>n(r)]}class me extends e{constructor(e){super(),t(this,e,ge,pe,a,{text:0,href:1,index:2,handleDelete:3,handleUpdate:4})}}function ve(e,t,a){const s=e.slice();return s[15]=t[a],s[16]=t,s[17]=a,s}function $e(e,t){let a,s,o,l,n;function i(e){t[9].call(null,e,t[15])}function d(e){t[10].call(null,e,t[15])}let u={handleUpdate:t[3],handleDelete:t[5],index:t[17]};return void 0!==t[15].text&&(u.text=t[15].text),void 0!==t[15].href&&(u.href=t[15].href),s=new me({props:u}),D.push(()=>S(s,"text",i)),D.push(()=>S(s,"href",d)),{key:e,first:null,c(){a=b(),k(s.$$.fragment),this.h()},l(e){a=b(),E(s.$$.fragment,e),this.h()},h(){this.first=a},m(e,t){c(e,a,t),P(s,e,t),n=!0},p(e,a){t=e;const r={};1&a&&(r.index=t[17]),!o&&1&a&&(o=!0,r.text=t[15].text,x(()=>o=!1)),!l&&1&a&&(l=!0,r.href=t[15].href,x(()=>l=!1)),s.$set(r)},i(e){n||(I(s.$$.fragment,e),n=!0)},o(e){T(s.$$.fragment,e),n=!1},d(e){e&&r(a),y(s,e)}}}function be(e){let t,a,i,m,b,k,E,P,x,y,L,D,S,O,A,V,j,H,M,q,R,z,C,F,W,G,K,J,Q=[],X=new Map,Y=e[0];const Z=e=>e[17];for(let t=0;t<Y.length;t+=1){let a=ve(e,Y,t),s=Z(a);X.set(s,Q[t]=$e(s,a))}return{c(){t=s("p"),a=d("Logo"),i=u(),m=s("label"),b=d("Name"),k=u(),E=s("input"),P=u(),x=s("label"),y=d("Link"),L=u(),D=s("input"),S=u(),O=s("div"),A=s("label"),V=d("Image"),j=u(),H=s("input"),M=u(),q=s("p"),R=d("Links"),z=u();for(let e=0;e<Q.length;e+=1)Q[e].c();C=u(),F=s("button"),W=d("Add"),this.h()},l(e){t=o(e,"P",{});var s=l(t);a=f(s,"Logo"),s.forEach(r),i=h(e),m=o(e,"LABEL",{for:!0});var n=l(m);b=f(n,"Name"),n.forEach(r),k=h(e),E=o(e,"INPUT",{id:!0,type:!0}),P=h(e),x=o(e,"LABEL",{for:!0});var c=l(x);y=f(c,"Link"),c.forEach(r),L=h(e),D=o(e,"INPUT",{id:!0,type:!0}),S=h(e),O=o(e,"DIV",{class:!0});var d=l(O);A=o(d,"LABEL",{for:!0});var u=l(A);V=f(u,"Image"),u.forEach(r),j=h(d),H=o(d,"INPUT",{id:!0,type:!0,class:!0}),d.forEach(r),M=h(e),q=o(e,"P",{});var p=l(q);R=f(p,"Links"),p.forEach(r),z=h(e);for(let t=0;t<Q.length;t+=1)Q[t].l(e);C=h(e),F=o(e,"BUTTON",{});var g=l(F);W=f(g,"Add"),g.forEach(r),this.h()},h(){n(m,"for","logo-name-input"),n(E,"id","logo-name-input"),n(E,"type","text"),n(x,"for","logo-href"),n(D,"id","logo-href"),n(D,"type","text"),n(A,"for","logo-image-upload"),n(H,"id","logo-image-upload"),n(H,"type","file"),n(H,"class","svelte-1ss6k92"),n(O,"class","logo-image-upload-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,m,o),p(m,b),c(s,k,o),c(s,E,o),$(E,e[1]),c(s,P,o),c(s,x,o),p(x,y),c(s,L,o),c(s,D,o),$(D,e[2]),c(s,S,o),c(s,O,o),p(O,A),p(A,V),p(O,j),p(O,H),c(s,M,o),c(s,q,o),p(q,R),c(s,z,o);for(let e=0;e<Q.length;e+=1)Q[e].m(s,o);c(s,C,o),c(s,F,o),p(F,W),G=!0,K||(J=[g(E,"input",e[7]),g(E,"keyup",e[3]),g(D,"input",e[8]),g(D,"keyup",e[3]),g(F,"click",e[11])],K=!0)},p(e,[t]){if(2&t&&E.value!==e[1]&&$(E,e[1]),4&t&&D.value!==e[2]&&$(D,e[2]),41&t){const a=e[0];w(),Q=B(Q,t,Z,1,e,a,X,C.parentNode,N,$e,C,ve),U()}},i(e){if(!G){for(let e=0;e<Y.length;e+=1)I(Q[e]);G=!0}},o(e){for(let e=0;e<Q.length;e+=1)T(Q[e]);G=!1},d(e){e&&r(t),e&&r(i),e&&r(m),e&&r(k),e&&r(E),e&&r(P),e&&r(x),e&&r(L),e&&r(D),e&&r(S),e&&r(O),e&&r(M),e&&r(q),e&&r(z);for(let t=0;t<Q.length;t+=1)Q[t].d(e);e&&r(C),e&&r(F),K=!1,v(J)}}}function ke(e,t,a){let s;L(e,G,e=>a(13,s=e));let o,{elementId:l}=t,r=K(s,l),n=r?r.name:"",c=r?r.href:"";const i=()=>{J(Q({elementId:l,menuData:o,logoData:r}))},d=()=>{a(0,o=[...o,{text:"New Item",href:""}]),i()};return e.$$set=e=>{"elementId"in e&&a(6,l=e.elementId)},e.$$.update=()=>{8256&e.$$.dirty&&a(0,o=s.elementProps[l].menuData||[])},[o,n,c,()=>{r=Object.assign(Object.assign({},r),{name:n,href:c}),i()},d,e=>{a(0,o=o.filter((t,a)=>a!==e)),i()},l,function(){n=this.value,a(1,n)},function(){c=this.value,a(2,c)},function(e,t){t.text=e,a(0,o),a(13,s),a(6,l)},function(e,t){t.href=e,a(0,o),a(13,s),a(6,l)},()=>d()]}class Ee extends e{constructor(e){super(),t(this,e,ke,be,a,{elementId:6})}}function Pe(e){let t,a,n,u;return{c(){t=s("button"),a=d("Select Parent")},l(e){t=o(e,"BUTTON",{});var s=l(t);a=f(s,"Select Parent"),s.forEach(r)},m(s,o){c(s,t,o),p(t,a),n||(u=g(t,"click",e[2]),n=!0)},p:i,i:i,o:i,d(e){e&&r(t),n=!1,u()}}}function xe(e,t,a){let s;L(e,G,e=>a(0,s=e));const o=e=>{let t=X(e),a=Y({store:e,blockId:t})||Z({store:e,blockId:t});J(_({id:a}))};return[s,o,()=>o(s)]}class Ie extends e{constructor(e){super(),t(this,e,xe,Pe,a,{})}}function Te(e){let t,a,i,b,x,w,B,N,U,L,D,S,O,A,V,j,H,M,q,R,z,C,F,W,G,K,J,Q,X,Y,Z,_=ee(e[2])?"Split Vertically":"Split Horizontally";return b=new Ie({}),{c(){t=s("h3"),a=d("Block Settings"),i=u(),k(b.$$.fragment),x=u(),w=s("button"),B=d(_),N=u(),U=s("button"),L=d("Delete Block"),D=u(),S=s("div"),O=s("label"),A=d("Background Image"),V=u(),j=s("input"),H=u(),M=s("label"),q=d("Background Color"),R=u(),z=s("div"),C=s("input"),F=u(),W=s("button"),G=d("Set"),K=u(),J=s("button"),Q=d("Reset Background"),this.h()},l(e){t=o(e,"H3",{});var s=l(t);a=f(s,"Block Settings"),s.forEach(r),i=h(e),E(b.$$.fragment,e),x=h(e),w=o(e,"BUTTON",{});var n=l(w);B=f(n,_),n.forEach(r),N=h(e),U=o(e,"BUTTON",{});var c=l(U);L=f(c,"Delete Block"),c.forEach(r),D=h(e),S=o(e,"DIV",{class:!0});var d=l(S);O=o(d,"LABEL",{for:!0,class:!0});var u=l(O);A=f(u,"Background Image"),u.forEach(r),V=h(d),j=o(d,"INPUT",{type:!0,id:!0,class:!0}),H=h(d),M=o(d,"LABEL",{for:!0,class:!0});var p=l(M);q=f(p,"Background Color"),p.forEach(r),R=h(d),z=o(d,"DIV",{class:!0});var g=l(z);C=o(g,"INPUT",{id:!0,type:!0,class:!0}),F=h(g),W=o(g,"BUTTON",{class:!0});var m=l(W);G=f(m,"Set"),m.forEach(r),g.forEach(r),d.forEach(r),K=h(e),J=o(e,"BUTTON",{class:!0});var v=l(J);Q=f(v,"Reset Background"),v.forEach(r),this.h()},h(){n(O,"for","background-image-upload"),n(O,"class","svelte-5hiwhc"),n(j,"type","file"),n(j,"id","background-image-upload"),n(j,"class","svelte-5hiwhc"),n(M,"for","background-color-picker"),n(M,"class","svelte-5hiwhc"),n(C,"id","background-color-picker"),n(C,"type","color"),n(C,"class","svelte-5hiwhc"),n(W,"class","color-picker-btn svelte-5hiwhc"),n(z,"class","color-setting-container svelte-5hiwhc"),n(S,"class","input-container"),n(J,"class","reset-background svelte-5hiwhc")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),P(b,s,o),c(s,x,o),c(s,w,o),p(w,B),c(s,N,o),c(s,U,o),p(U,L),c(s,D,o),c(s,S,o),p(S,O),p(O,A),p(S,V),p(S,j),e[10](j),p(S,H),p(S,M),p(M,q),p(S,R),p(S,z),p(z,C),$(C,e[1]),p(z,F),p(z,W),p(W,G),c(s,K,o),c(s,J,o),p(J,Q),X=!0,Y||(Z=[g(w,"click",e[8]),g(U,"click",e[9]),g(j,"change",e[5]),g(C,"input",e[11]),g(W,"click",e[7]),g(J,"click",e[6])],Y=!0)},p(e,[t]){(!X||4&t)&&_!==(_=ee(e[2])?"Split Vertically":"Split Horizontally")&&m(B,_),2&t&&$(C,e[1])},i(e){X||(I(b.$$.fragment,e),X=!0)},o(e){T(b.$$.fragment,e),X=!1},d(a){a&&r(t),a&&r(i),y(b,a),a&&r(x),a&&r(w),a&&r(N),a&&r(U),a&&r(D),a&&r(S),e[10](null),a&&r(K),a&&r(J),Y=!1,v(Z)}}}function ye(e,t,a){let s,o,l;L(e,G,e=>a(2,s=e));let r="#000000";const n=()=>{te(l,s)},c=()=>{ae(l)};return e.$$.update=()=>{4&e.$$.dirty&&(l=X(s))},[o,r,s,n,c,()=>{if(o.files&&o.files[0]){let e=URL.createObjectURL(o.files[0]);console.log("tempUrl",e),J(se({blockId:l,url:e,reload:!0})),console.log("blockProps",s.blockProps[l]),M({file:o.files[0]}).then(e=>{J(se({blockId:l,url:e.data.data.url}))}).catch(()=>console.log("handleUpload: failed to upload to host"))}},()=>{J(se({blockId:l,reload:!0})),J(oe({blockId:l,color:""}))},()=>{J(oe({blockId:l,color:r}))},()=>n(),()=>c(),function(e){D[e?"unshift":"push"](()=>{o=e,a(0,o)})},function(){r=this.value,a(1,r)}]}class we extends e{constructor(e){super(),t(this,e,ye,Te,a,{})}}function Be(e){let t,a,i,$,b,k,E,P,x,y,w,B,N,U,L,D,S,j,H,M,q,R,z="Status: "+(e[0].saved?"Saved":"Modified"),C=e[0].pageProps.editingLayout?"Preview Page":"Edit Page",F=e[0].published?"Unpublish Page":"Publish Page",W=e[0].pageProps.editingLayout?"Preview":"Edit";const G=e[5].default,K=O(G,e,e[4],null);return{c(){t=s("div"),a=s("div"),i=d(z),$=u(),b=s("button"),k=d("x"),E=u(),P=s("button"),x=d(C),y=u(),w=s("button"),B=d(F),N=u(),K&&K.c(),U=u(),L=s("button"),D=d("Show Toolbar"),S=u(),j=s("button"),H=d(W),this.h()},l(e){t=o(e,"DIV",{id:!0,class:!0});var s=l(t);a=o(s,"DIV",{class:!0});var n=l(a);i=f(n,z),n.forEach(r),$=h(s),b=o(s,"BUTTON",{class:!0});var c=l(b);k=f(c,"x"),c.forEach(r),E=h(s),P=o(s,"BUTTON",{class:!0});var d=l(P);x=f(d,C),d.forEach(r),y=h(s),w=o(s,"BUTTON",{class:!0});var u=l(w);B=f(u,F),u.forEach(r),N=h(s),K&&K.l(s),s.forEach(r),U=h(e),L=o(e,"BUTTON",{class:!0});var p=l(L);D=f(p,"Show Toolbar"),p.forEach(r),S=h(e),j=o(e,"BUTTON",{class:!0});var g=l(j);H=f(g,W),g.forEach(r),this.h()},h(){n(a,"class","status svelte-1taoa0b"),n(b,"class","close-toolbar-btn svelte-1taoa0b"),n(P,"class","svelte-1taoa0b"),n(w,"class","svelte-1taoa0b"),n(t,"id","toolbar"),n(t,"class","svelte-1taoa0b"),A(t,"hidden",!e[0].pageProps.showToolbar),n(L,"class","toolbar-toggle svelte-1taoa0b"),A(L,"hidden",le(e[0])),n(j,"class","preview-btn svelte-1taoa0b"),A(j,"hidden",le(e[0]))},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,$),p(t,b),p(b,k),p(t,E),p(t,P),p(P,x),p(t,y),p(t,w),p(w,B),p(t,N),K&&K.m(t,null),c(s,U,o),c(s,L,o),p(L,D),c(s,S,o),c(s,j,o),p(j,H),M=!0,q||(R=[g(b,"click",e[2]),g(P,"click",e[1]),g(w,"click",e[3]),g(L,"click",e[2]),g(j,"click",e[1])],q=!0)},p(e,[a]){(!M||1&a)&&z!==(z="Status: "+(e[0].saved?"Saved":"Modified"))&&m(i,z),(!M||1&a)&&C!==(C=e[0].pageProps.editingLayout?"Preview Page":"Edit Page")&&m(x,C),(!M||1&a)&&F!==(F=e[0].published?"Unpublish Page":"Publish Page")&&m(B,F),K&&K.p&&16&a&&V(K,G,e,e[4],a,null,null),1&a&&A(t,"hidden",!e[0].pageProps.showToolbar),1&a&&A(L,"hidden",le(e[0])),(!M||1&a)&&W!==(W=e[0].pageProps.editingLayout?"Preview":"Edit")&&m(H,W),1&a&&A(j,"hidden",le(e[0]))},i(e){M||(I(K,e),M=!0)},o(e){T(K,e),M=!1},d(e){e&&r(t),K&&K.d(e),e&&r(U),e&&r(L),e&&r(S),e&&r(j),q=!1,v(R)}}}function Ne(e,t,a){let s;L(e,G,e=>a(0,s=e));let{$$slots:o={},$$scope:l}=t;return e.$$set=e=>{"$$scope"in e&&a(4,l=e.$$scope)},[s,()=>{s.pageProps.editingLayout&&J(_({id:""})),J(re()),J(ne())},()=>J(ce()),()=>J(ie()),l,o]}class Ue extends e{constructor(e){super(),t(this,e,Ne,Be,a,{})}}function Le(e){let t;return{c(){t=d("Select a block to change its settings")},l(e){t=f(e,"Select a block to change its settings")},m(e,a){c(e,t,a)},p:i,i:i,o:i,d(e){e&&r(t)}}}function De(e){let t,a,i,g,m,v,$,x="menu"===e[2](e[0]).type;t=new we({});let B=x&&Se(e);return{c(){k(t.$$.fragment),a=u(),i=s("h3"),g=d("Element Settings"),m=u(),B&&B.c(),v=b(),this.h()},l(e){E(t.$$.fragment,e),a=h(e),i=o(e,"H3",{class:!0});var s=l(i);g=f(s,"Element Settings"),s.forEach(r),m=h(e),B&&B.l(e),v=b(),this.h()},h(){n(i,"class","element-title svelte-1to17tn")},m(e,s){P(t,e,s),c(e,a,s),c(e,i,s),p(i,g),c(e,m,s),B&&B.m(e,s),c(e,v,s),$=!0},p(e,t){1&t&&(x="menu"===e[2](e[0]).type),x?B?(B.p(e,t),1&t&&I(B,1)):(B=Se(e),B.c(),I(B,1),B.m(v.parentNode,v)):B&&(w(),T(B,1,1,()=>{B=null}),U())},i(e){$||(I(t.$$.fragment,e),I(B),$=!0)},o(e){T(t.$$.fragment,e),T(B),$=!1},d(e){y(t,e),e&&r(a),e&&r(i),e&&r(m),B&&B.d(e),e&&r(v)}}}function Se(e){let t,a;return t=new Ee({props:{elementId:e[1](e[0])}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,a){const s={};1&a&&(s.elementId=e[1](e[0])),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){y(t,e)}}}function Oe(e){let t,a,s,o,l;const n=[De,Le],i=[];function d(e,a){return 1&a&&(t=!!e[2](e[0])),t?0:1}return a=d(e,-1),s=i[a]=n[a](e),{c(){s.c(),o=b()},l(e){s.l(e),o=b()},m(e,t){i[a].m(e,t),c(e,o,t),l=!0},p(e,t){let l=a;a=d(e,t),a===l?i[a].p(e,t):(w(),T(i[l],1,1,()=>{i[l]=null}),U(),s=i[a],s||(s=i[a]=n[a](e),s.c()),I(s,1),s.m(o.parentNode,o))},i(e){l||(I(s),l=!0)},o(e){T(s),l=!1},d(e){i[a].d(e),e&&r(o)}}}function Ae(e){let t,a;return t=new Ue({props:{$$slots:{default:[Oe]},$$scope:{ctx:e}}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,[a]){const s={};9&a&&(s.$$scope={dirty:a,ctx:e}),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){y(t,e)}}}function Ve(e,t,a){let s;L(e,G,e=>a(0,s=e));const o=e=>{let t=(e.pageProps.focusedBlock||{}).id;if(e.blockProps[t])return(e.blockProps[t].elements||[void 0])[0]};return[s,o,e=>{let t=o(e);if(t)return e.elementProps[t]}]}class je extends e{constructor(e){super(),t(this,e,Ve,Ae,a,{})}}function He(e){let t,a,i,d,f,m,v,$,b;return d=new de({}),m=new je({}),{c(){t=s("main"),a=s("div"),i=s("div"),k(d.$$.fragment),f=u(),k(m.$$.fragment),this.h()},l(e){t=o(e,"MAIN",{class:!0});var s=l(t);a=o(s,"DIV",{class:!0});var n=l(a);i=o(n,"DIV",{class:!0});var c=l(i);E(d.$$.fragment,c),c.forEach(r),n.forEach(r),f=h(s),E(m.$$.fragment,s),s.forEach(r),this.h()},h(){n(i,"class","block svelte-52p31m"),n(a,"class","page svelte-52p31m"),A(a,"makeWayForToolbar",le(e[1])),n(t,"class","svelte-52p31m"),A(t,"hidden",e[0])},m(s,o){c(s,t,o),p(t,a),p(a,i),P(d,i,null),p(t,f),P(m,t,null),v=!0,$||(b=g(a,"click",e[6]),$=!0)},p(e,[s]){2&s&&A(a,"makeWayForToolbar",le(e[1])),1&s&&A(t,"hidden",e[0])},i(e){v||(I(d.$$.fragment,e),I(m.$$.fragment,e),v=!0)},o(e){T(d.$$.fragment,e),T(m.$$.fragment,e),v=!1},d(e){e&&r(t),y(d),y(m),$=!1,b()}}}var Me=function(e,t,a,s){return new(a||(a=Promise))((function(o,l){function r(e){try{c(s.next(e))}catch(e){l(e)}}function n(e){try{c(s.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,n)}c((s=s.apply(e,t||[])).next())}))};function qe(e,t){return Me(this,void 0,void 0,(function*(){try{const a=e.params.pageId,s=q(a);if(!t.userId)return void this.redirect(302,R(a));const o=yield this.fetch(s),l=yield o.json();return l?"true"===e.query.create?void this.redirect(302,z(a)):(G.set(l),{storePreloaded:l,pageId:a,create:!1,csrf:t.csrf}):"true"===e.query.create?{pageId:a,create:!0,storePreloaded:void 0,csrf:t.csrf}:void this.error(404,"Page not found")}catch(e){this.error(500,e)}}))}function Re(e,t,a){let s;L(e,G,e=>a(1,s=e));let{storePreloaded:o}=t,{pageId:l}=t,{create:r}=t,{csrf:n}=t,c=!0;C(n),o&&j(G,s=o,s);const i=()=>{W(l,s).then(()=>{console.log("saved"),J(ue())}).catch(()=>console.log("save error:"))},d=()=>{i(),setInterval(()=>{s.saved||i()},5e3),window.onbeforeunload=()=>{s.saved||(alert("Page not saved, confirm to leave?"),i())}},u=()=>{F(l).then(e=>{e.data?(console.log("Page already exist, redirecting"),window.location.assign(window.location.href.replace("?create=true",""))):d()}).catch(e=>{console.log("get Page error retrying in 5s",e),setTimeout(u,5e3)})};H(()=>{r?u():d(),a(0,c=!1)});return e.$$set=e=>{"storePreloaded"in e&&a(2,o=e.storePreloaded),"pageId"in e&&a(3,l=e.pageId),"create"in e&&a(4,r=e.create),"csrf"in e&&a(5,n=e.csrf)},[c,s,o,l,r,n,()=>J(_({id:""}))]}export default class extends e{constructor(e){super(),t(this,e,Re,He,a,{storePreloaded:2,pageId:3,create:4,csrf:5})}}export{qe as preload};
