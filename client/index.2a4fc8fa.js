import{S as e,i as t,s as a,e as r,c as n,a as s,d as l,b as o,f as c,n as h,t as i,g as u,h as f,j as p,k as m,l as d,m as g,o as v,p as $,q as E,r as w,u as A,v as L,w as j,x as I,y as P}from"./client.a86f1b76.js";import{l as x,L as y,P as b}from"./index.ea2af0eb.js";import{v as N}from"./v4.96b22442.js";function S(e){let t,a,d,g,v,$,E,w;return{c(){t=r("a"),a=i("Register"),d=u(),g=r("span"),v=i("|"),$=u(),E=r("a"),w=i("Login"),this.h()},l(e){t=n(e,"A",{href:!0});var r=s(t);a=f(r,"Register"),r.forEach(l),d=p(e),g=n(e,"SPAN",{});var o=s(g);v=f(o,"|"),o.forEach(l),$=p(e),E=n(e,"A",{href:!0});var c=s(E);w=f(c,"Login"),c.forEach(l),this.h()},h(){o(t,"href","/auth/register"),o(E,"href","/auth/login")},m(e,r){c(e,t,r),m(t,a),c(e,d,r),c(e,g,r),m(g,v),c(e,$,r),c(e,E,r),m(E,w)},p:h,d(e){e&&l(t),e&&l(d),e&&l(g),e&&l($),e&&l(E)}}}function k(e){let t,a,h,v,$,E,w,A,L,j;return{c(){t=r("span"),a=i(e[0]),h=u(),v=r("span"),$=i("|"),E=u(),w=r("span"),A=i("Logout"),this.h()},l(r){t=n(r,"SPAN",{class:!0});var o=s(t);a=f(o,e[0]),o.forEach(l),h=p(r),v=n(r,"SPAN",{});var c=s(v);$=f(c,"|"),c.forEach(l),E=p(r),w=n(r,"SPAN",{class:!0});var i=s(w);A=f(i,"Logout"),i.forEach(l),this.h()},h(){o(t,"class","username"),o(w,"class","logout svelte-4wajjh")},m(r,n){c(r,t,n),m(t,a),c(r,h,n),c(r,v,n),m(v,$),c(r,E,n),c(r,w,n),m(w,A),L||(j=d(w,"click",e[1]),L=!0)},p(e,t){1&t&&g(a,e[0])},d(e){e&&l(t),e&&l(h),e&&l(v),e&&l(E),e&&l(w),L=!1,j()}}}function M(e){let t;function a(e,t){return e[0]?k:S}let i=a(e),u=i(e);return{c(){t=r("div"),u.c(),this.h()},l(e){t=n(e,"DIV",{class:!0});var a=s(t);u.l(a),a.forEach(l),this.h()},h(){o(t,"class","user-menu svelte-4wajjh")},m(e,a){c(e,t,a),u.m(t,null)},p(e,[r]){i===(i=a(e))&&u?u.p(e,r):(u.d(1),u=i(e),u&&(u.c(),u.m(t,null)))},i:h,o:h,d(e){e&&l(t),u.d()}}}function R(e,t,a){let{username:r}=t;return e.$$set=e=>{"username"in e&&a(0,r=e.username)},[r,()=>{x().then(()=>window.location.reload()).catch(e=>console.log("Logout error"))}]}class _ extends e{constructor(e){super(),t(this,e,R,M,a,{username:0})}}function U(e,t,a){const r=e.slice();return r[7]=t[a],r}function q(e){let t,a,h,g,$,E,w,A,L=e[3]&&B(e);return{c(){t=r("form"),a=r("label"),h=i("Enter a page title"),g=u(),$=r("input"),E=u(),L&&L.c(),this.h()},l(e){t=n(e,"FORM",{});var r=s(t);a=n(r,"LABEL",{for:!0});var o=s(a);h=f(o,"Enter a page title"),o.forEach(l),g=p(r),$=n(r,"INPUT",{id:!0}),E=p(r),L&&L.l(r),r.forEach(l),this.h()},h(){o(a,"for","page-name-input"),o($,"id","page-name-input")},m(r,n){c(r,t,n),m(t,a),m(a,h),m(t,g),m(t,$),v($,e[3]),m(t,E),L&&L.m(t,null),w||(A=d($,"input",e[5]),w=!0)},p(e,a){8&a&&$.value!==e[3]&&v($,e[3]),e[3]?L?L.p(e,a):(L=B(e),L.c(),L.m(t,null)):L&&(L.d(1),L=null)},d(e){e&&l(t),L&&L.d(),w=!1,A()}}}function B(e){let t,a,h;return{c(){t=r("a"),a=i("create"),this.h()},l(e){t=n(e,"A",{href:!0});var r=s(t);a=f(r,"create"),r.forEach(l),this.h()},h(){o(t,"href",h=e[4](e[3]))},m(e,r){c(e,t,r),m(t,a)},p(e,a){8&a&&h!==(h=e[4](e[3]))&&o(t,"href",h)},d(e){e&&l(t)}}}function D(e,t){let a,h,d,v,$,E=`${t[7].pageId.replace(T,"").replace("_"," ")} ${t[7].published?"":"(draft)"}`;return{key:e,first:null,c(){a=r("li"),h=r("a"),d=i(E),$=u(),this.h()},l(e){a=n(e,"LI",{});var t=s(a);h=n(t,"A",{href:!0});var r=s(h);d=f(r,E),r.forEach(l),$=p(t),t.forEach(l),this.h()},h(){o(h,"href",v="/"+t[7].pageId),this.first=a},m(e,t){c(e,a,t),m(a,h),m(h,d),m(a,$)},p(e,t){1&t&&E!==(E=`${e[7].pageId.replace(T,"").replace("_"," ")} ${e[7].published?"":"(draft)"}`)&&g(d,E),1&t&&v!==(v="/"+e[7].pageId)&&o(h,"href",v)},d(e){e&&l(a)}}}function F(e){let t,a,h,d,v,x,y,b,N,S=e[2]+"'s Pages",k=[],M=new Map;v=new _({props:{username:e[1]}});let R=e[1]&&q(e),B=e[0]||[];const F=e=>e[7].pageId;for(let t=0;t<B.length;t+=1){let a=U(e,B,t),r=F(a);M.set(r,k[t]=D(r,a))}return{c(){t=r("main"),a=r("h1"),h=i(S),d=u(),$(v.$$.fragment),x=u(),R&&R.c(),y=u(),b=r("ul");for(let e=0;e<k.length;e+=1)k[e].c();this.h()},l(e){t=n(e,"MAIN",{class:!0});var r=s(t);a=n(r,"H1",{});var o=s(a);h=f(o,S),o.forEach(l),d=p(r),E(v.$$.fragment,r),x=p(r),R&&R.l(r),y=p(r),b=n(r,"UL",{});var c=s(b);for(let e=0;e<k.length;e+=1)k[e].l(c);c.forEach(l),r.forEach(l),this.h()},h(){o(t,"class","svelte-1u6d46m")},m(e,r){c(e,t,r),m(t,a),m(a,h),m(t,d),w(v,t,null),m(t,x),R&&R.m(t,null),m(t,y),m(t,b);for(let e=0;e<k.length;e+=1)k[e].m(b,null);N=!0},p(e,[a]){(!N||4&a)&&S!==(S=e[2]+"'s Pages")&&g(h,S);const r={};if(2&a&&(r.username=e[1]),v.$set(r),e[1]?R?R.p(e,a):(R=q(e),R.c(),R.m(t,y)):R&&(R.d(1),R=null),1&a){const t=e[0]||[];k=A(k,a,F,1,e,t,M,b,P,D,null,U)}},i(e){N||(L(v.$$.fragment,e),N=!0)},o(e){j(v.$$.fragment,e),N=!1},d(e){e&&l(t),I(v),R&&R.d();for(let e=0;e<k.length;e+=1)k[e].d()}}}var H=function(e,t,a,r){return new(a||(a=Promise))((function(n,s){function l(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}c((r=r.apply(e,t||[])).next())}))};function O(e,t){return H(this,void 0,void 0,(function*(){try{const e=t.username;e||this.redirect(302,y);let a=b;const r=yield this.fetch(a);return{pages:yield r.json(),username:t.username,owner:e}}catch(e){this.error(500,e)}}))}let T=/-.{8}$/g;function V(e,t,a){let r,{pages:n}=t,{username:s}=t,{owner:l}=t,o=N().split("-")[0];return e.$$set=e=>{"pages"in e&&a(0,n=e.pages),"username"in e&&a(1,s=e.username),"owner"in e&&a(2,l=e.owner)},[n,s,l,r,e=>`/${e.replace(" ","_")}-${o}/edit/?create=true`,function(){r=this.value,a(3,r)}]}export default class extends e{constructor(e){super(),t(this,e,V,F,a,{pages:0,username:1,owner:2})}}export{O as preload};
