import{S as t,i as e,s,e as r,t as a,c as n,a as i,h as o,d as c,b as u,f as l,k as h,m as p,g as d,j as f,r as v,l as b,n as m,z as g}from"./client.65f83058.js";import{s as w,a as y,r as E}from"./index.02369f4d.js";function x(t){let e,s;return{c(){e=r("p"),s=a(t[3]),this.h()},l(r){e=n(r,"P",{class:!0});var a=i(e);s=o(a,t[3]),a.forEach(c),this.h()},h(){u(e,"class","error svelte-143j1bp")},m(t,r){l(t,e,r),h(e,s)},p(t,e){8&e&&p(s,t[3])},d(t){t&&c(e)}}}function T(t){let e,s,p,w,y,E,T,j,I,P,U,L,N,S,B,q,R,z,D,O,k,A,G,V,$,F,H,M,_=t[4].h1+"",C=t[4].buttonText+"",J=t[3]&&x(t);return{c(){e=r("div"),s=r("div"),p=r("h1"),w=a(_),y=d(),J&&J.c(),E=d(),T=r("form"),j=r("label"),I=a("Username"),P=d(),U=r("input"),L=d(),N=r("label"),S=a("Password"),B=d(),q=r("input"),R=d(),z=r("input"),D=d(),O=r("button"),k=a(C),A=d(),G=r("br"),V=d(),$=r("button"),F=a("Sign In with Github"),this.h()},l(t){e=n(t,"DIV",{class:!0});var r=i(e);s=n(r,"DIV",{class:!0});var a=i(s);p=n(a,"H1",{class:!0});var u=i(p);w=o(u,_),u.forEach(c),y=f(a),J&&J.l(a),E=f(a),T=n(a,"FORM",{class:!0});var l=i(T);j=n(l,"LABEL",{for:!0});var h=i(j);I=o(h,"Username"),h.forEach(c),P=f(l),U=n(l,"INPUT",{id:!0,type:!0,required:!0}),L=f(l),N=n(l,"LABEL",{for:!0});var d=i(N);S=o(d,"Password"),d.forEach(c),B=f(l),q=n(l,"INPUT",{id:!0,type:!0,required:!0}),R=f(l),z=n(l,"INPUT",{hidden:!0,value:!0}),D=f(l),O=n(l,"BUTTON",{class:!0});var v=i(O);k=o(v,C),v.forEach(c),l.forEach(c),A=f(a),G=n(a,"BR",{}),V=f(a),$=n(a,"BUTTON",{});var b=i($);F=o(b,"Sign In with Github"),b.forEach(c),a.forEach(c),r.forEach(c),this.h()},h(){u(p,"class","svelte-143j1bp"),u(j,"for","username-input"),u(U,"id","username-input"),u(U,"type","text"),U.required=!0,u(N,"for","password-input-1"),u(q,"id","password-input-1"),u(q,"type","password"),q.required=!0,z.hidden=!0,z.value=t[0],u(O,"class","capitalize submit-btn svelte-143j1bp"),u(T,"class","svelte-143j1bp"),u(s,"class","panel svelte-143j1bp"),u(e,"class","input-container svelte-143j1bp")},m(r,a){l(r,e,a),h(e,s),h(s,p),h(p,w),h(s,y),J&&J.m(s,null),h(s,E),h(s,T),h(T,j),h(j,I),h(T,P),h(T,U),v(U,t[1]),h(T,L),h(T,N),h(N,S),h(T,B),h(T,q),v(q,t[2]),h(T,R),h(T,z),h(T,D),h(T,O),h(O,k),h(s,A),h(s,G),h(s,V),h(s,$),h($,F),H||(M=[b(U,"input",t[8]),b(q,"input",t[9]),b(T,"submit",t[5]),b($,"click",t[6])],H=!0)},p(t,[e]){t[3]?J?J.p(t,e):(J=x(t),J.c(),J.m(s,E)):J&&(J.d(1),J=null),2&e&&U.value!==t[1]&&v(U,t[1]),4&e&&q.value!==t[2]&&v(q,t[2]),1&e&&z.value!==t[0]&&(z.value=t[0])},i:m,o:m,d(t){t&&c(e),J&&J.d(),H=!1,g(M)}}}var j=function(t,e,s,r){return new(s||(s=Promise))((function(a,n){function i(t){try{c(r.next(t))}catch(t){n(t)}}function o(t){try{c(r.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(i,o)}c((r=r.apply(t,e||[])).next())}))};function I(t,e){return j(this,void 0,void 0,(function*(){let s=t.params.type;["login","register"].includes(s)||this.error(404,"Not found");const{user:r,csrf:a}=e||{};return r?this.redirect(302,"/"):{csrf:a,type:s}}))}function P(t,e,s){let{csrf:r}=e,{type:a}=e;w(r);const n={login:{h1:"Log In",buttonText:"Login",handleSubmit:y},register:{h1:"Register for an account",buttonText:"Register",handleSubmit:E}}[a];let i,o,c;return t.$$set=t=>{"csrf"in t&&s(0,r=t.csrf),"type"in t&&s(7,a=t.type)},[r,i,o,c,n,t=>{t.preventDefault(),n.handleSubmit({username:i,password:o,csrf:r}).then(t=>{console.log("redirecting to ","/"),window.location.assign("/")}).catch(t=>s(3,c=t.response.data.error))},()=>{window.location.assign("https://github.com/login/oauth/authorize?client_id=3df9d370158b20b1b0c2&scope=user repo")},a,function(){i=this.value,s(1,i)},function(){o=this.value,s(2,o)}]}export default class extends t{constructor(t){super(),e(this,t,P,T,s,{csrf:0,type:7})}}export{I as preload};
