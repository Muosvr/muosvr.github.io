import{S as e,i as s,s as a,e as t,t as n,c as r,a as o,h as i,d as c,b as l,f as d,k as u,n as f,p as h,g as m,q as p,j as g,A as v,r as $,v as w,w as P,x,B as I,C as j,D as y}from"./client.d26e5301.js";import{L as b,g as E}from"./index.ea2af0eb.js";import"./v4.96b22442.js";import{s as k,B}from"./Block.ffd055ef.js";function z(e){let s,a;return{c(){s=t("a"),a=n("Edit this page"),this.h()},l(e){s=r(e,"A",{class:!0,href:!0});var t=o(s);a=i(t,"Edit this page"),t.forEach(c),this.h()},h(){l(s,"class","edit-btn svelte-106zl87"),l(s,"href",e[3])},m(e,t){d(e,s,t),u(s,a)},p:f,d(e){e&&c(s)}}}function A(e){let s,a,n,i,f;n=new B({});let I=e[1]===e[0]&&z(e);return{c(){s=t("main"),a=t("div"),h(n.$$.fragment),i=m(),I&&I.c(),this.h()},l(e){s=r(e,"MAIN",{class:!0});var t=o(s);a=r(t,"DIV",{class:!0});var l=o(a);p(n.$$.fragment,l),l.forEach(c),i=g(t),I&&I.l(t),t.forEach(c),this.h()},h(){l(a,"class","block svelte-106zl87"),l(s,"class","svelte-106zl87"),v(s,"hidden",e[2])},m(e,t){d(e,s,t),u(s,a),$(n,a,null),u(s,i),I&&I.m(s,null),f=!0},p(e,[a]){e[1]===e[0]?I?I.p(e,a):(I=z(e),I.c(),I.m(s,null)):I&&(I.d(1),I=null),4&a&&v(s,"hidden",e[2])},i(e){f||(w(n.$$.fragment,e),f=!0)},o(e){P(n.$$.fragment,e),f=!1},d(e){e&&c(s),x(n),I&&I.d()}}}var D=function(e,s,a,t){return new(a||(a=Promise))((function(n,r){function o(e){try{c(t.next(e))}catch(e){r(e)}}function i(e){try{c(t.throw(e))}catch(e){r(e)}}function c(e){var s;e.done?n(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,i)}c((t=t.apply(e,s||[])).next())}))};function L(e,s){return D(this,void 0,void 0,(function*(){try{const{pageId:a}=e.params,t=s.username;if(console.log("session username",t),!t)return void this.redirect(b);const n=`/${a}.json`,r=yield this.fetch(n),o=yield r.json();return o?(o.pageProps.editingLayout=!1,o.pageProps.focusedBlock="",k.set(o),{storePreloaded:o,pageId:a,owner:t,create:!1,username:s.username}):void this.error(404,"Page does not exist")}catch(e){this.error(500,e)}}))}function q(e,s,a){let t;I(e,k,e=>a(6,t=e));let{storePreloaded:n}=s,{owner:r}=s,{username:o}=s,{pageId:i}=s;const c=E(i);let l=!0;return n&&j(k,t=n,t),y(()=>a(2,l=!1)),e.$$set=e=>{"storePreloaded"in e&&a(4,n=e.storePreloaded),"owner"in e&&a(0,r=e.owner),"username"in e&&a(1,o=e.username),"pageId"in e&&a(5,i=e.pageId)},[r,o,l,c,n,i]}export default class extends e{constructor(e){super(),s(this,e,q,A,a,{storePreloaded:4,owner:0,username:1,pageId:5})}}export{L as preload};
