import{S as t,i as e,s,e as a,t as r,c as n,a as i,h as o,d as c,b as u,f as l,k as h,m as p,g as d,j as f,r as v,l as b,n as m,z as g}from"./client.8b5d2d74.js";import{s as w,a as y,r as E}from"./index.ef1483ad.js";function x(t){let e,s;return{c(){e=a("p"),s=r(t[3]),this.h()},l(a){e=n(a,"P",{class:!0});var r=i(e);s=o(r,t[3]),r.forEach(c),this.h()},h(){u(e,"class","error svelte-143j1bp")},m(t,a){l(t,e,a),h(e,s)},p(t,e){8&e&&p(s,t[3])},d(t){t&&c(e)}}}function T(t){let e,s,p,w,y,E,T,j,I,P,U,L,N,S,B,q,R,z,D,O,k,A,G,V,$,F,H,M,_=t[4].h1+"",C=t[4].buttonText+"",J=t[3]&&x(t);return{c(){e=a("div"),s=a("div"),p=a("h1"),w=r(_),y=d(),J&&J.c(),E=d(),T=a("form"),j=a("label"),I=r("Username"),P=d(),U=a("input"),L=d(),N=a("label"),S=r("Password"),B=d(),q=a("input"),R=d(),z=a("input"),D=d(),O=a("button"),k=r(C),A=d(),G=a("br"),V=d(),$=a("button"),F=r("Sign In with Github"),this.h()},l(t){e=n(t,"DIV",{class:!0});var a=i(e);s=n(a,"DIV",{class:!0});var r=i(s);p=n(r,"H1",{class:!0});var u=i(p);w=o(u,_),u.forEach(c),y=f(r),J&&J.l(r),E=f(r),T=n(r,"FORM",{class:!0});var l=i(T);j=n(l,"LABEL",{for:!0});var h=i(j);I=o(h,"Username"),h.forEach(c),P=f(l),U=n(l,"INPUT",{id:!0,type:!0,required:!0}),L=f(l),N=n(l,"LABEL",{for:!0});var d=i(N);S=o(d,"Password"),d.forEach(c),B=f(l),q=n(l,"INPUT",{id:!0,type:!0,required:!0}),R=f(l),z=n(l,"INPUT",{hidden:!0,value:!0}),D=f(l),O=n(l,"BUTTON",{class:!0});var v=i(O);k=o(v,C),v.forEach(c),l.forEach(c),A=f(r),G=n(r,"BR",{}),V=f(r),$=n(r,"BUTTON",{});var b=i($);F=o(b,"Sign In with Github"),b.forEach(c),r.forEach(c),a.forEach(c),this.h()},h(){u(p,"class","svelte-143j1bp"),u(j,"for","username-input"),u(U,"id","username-input"),u(U,"type","text"),U.required=!0,u(N,"for","password-input-1"),u(q,"id","password-input-1"),u(q,"type","password"),q.required=!0,z.hidden=!0,z.value=t[0],u(O,"class","capitalize submit-btn svelte-143j1bp"),u(T,"class","svelte-143j1bp"),u(s,"class","panel svelte-143j1bp"),u(e,"class","input-container svelte-143j1bp")},m(a,r){l(a,e,r),h(e,s),h(s,p),h(p,w),h(s,y),J&&J.m(s,null),h(s,E),h(s,T),h(T,j),h(j,I),h(T,P),h(T,U),v(U,t[1]),h(T,L),h(T,N),h(N,S),h(T,B),h(T,q),v(q,t[2]),h(T,R),h(T,z),h(T,D),h(T,O),h(O,k),h(s,A),h(s,G),h(s,V),h(s,$),h($,F),H||(M=[b(U,"input",t[8]),b(q,"input",t[9]),b(T,"submit",t[5]),b($,"click",t[6])],H=!0)},p(t,[e]){t[3]?J?J.p(t,e):(J=x(t),J.c(),J.m(s,E)):J&&(J.d(1),J=null),2&e&&U.value!==t[1]&&v(U,t[1]),4&e&&q.value!==t[2]&&v(q,t[2]),1&e&&z.value!==t[0]&&(z.value=t[0])},i:m,o:m,d(t){t&&c(e),J&&J.d(),H=!1,g(M)}}}var j=function(t,e,s,a){return new(s||(s=Promise))((function(r,n){function i(t){try{c(a.next(t))}catch(t){n(t)}}function o(t){try{c(a.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(i,o)}c((a=a.apply(t,e||[])).next())}))};function I(t,e){return j(this,void 0,void 0,(function*(){let s=t.params.type;["login","register"].includes(s)||this.error(404,"Not found");const{user:a,csrf:r}=e||{};return a?this.redirect(302,"/"):{csrf:r,type:s}}))}function P(t,e,s){let{csrf:a}=e,{type:r}=e;w(a);const n={login:{h1:"Log In",buttonText:"Login",handleSubmit:y},register:{h1:"Register for an account",buttonText:"Register",handleSubmit:E}}[r];let i,o,c;return t.$$set=t=>{"csrf"in t&&s(0,a=t.csrf),"type"in t&&s(7,r=t.type)},[a,i,o,c,n,t=>{t.preventDefault(),n.handleSubmit({username:i,password:o,csrf:a}).then(t=>{console.log("redirecting to ","/"),window.location.assign("/")}).catch(t=>s(3,c=t.response.data.error))},()=>{window.location.assign("https://github.com/login/oauth/authorize?client_id=3df9d370158b20b1b0c2&scope=user repo")},r,function(){i=this.value,s(1,i)},function(){o=this.value,s(2,o)}]}export default class extends t{constructor(t){super(),e(this,t,P,T,s,{csrf:0,type:7})}}export{I as preload};
