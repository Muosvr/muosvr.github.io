import{S as e,i as t,s as a,e as s,c as o,a as l,d as r,b as n,f as c,n as i,t as d,g as u,h,j as f,k as p,l as g,m as v,z as m,r as $,G as b,o as k,p as E,q as P,M as x,v as I,w as T,x as B,H as y,u as w,L as N,I as U,B as L,K as D,N as S,O,A as V,P as A,C as j,D as H}from"./client.8b5d2d74.js";import{u as M,b as q,c as R,d as z,g as C,s as F,e as W,f as G}from"./index.ef1483ad.js";import"./v4.96b22442.js";import{s as K,a as J,d as Q,b as X,c as Y,e as Z,f as _,g as ee,h as te,i as ae,j as se,k as oe,l as le,m as re,t as ne,n as ce,o as ie,p as de,B as ue,q as he}from"./Block.7046eba8.js";function fe(e){let t,a,i,$,b,k,E,P,x,I,T;return{c(){t=s("span"),a=d(e[0]),i=u(),$=s("div"),b=s("button"),k=d("Edit"),E=u(),P=s("button"),x=d("Delete"),this.h()},l(s){t=o(s,"SPAN",{});var n=l(t);a=h(n,e[0]),n.forEach(r),i=f(s),$=o(s,"DIV",{class:!0});var c=l($);b=o(c,"BUTTON",{class:!0});var d=l(b);k=h(d,"Edit"),d.forEach(r),E=f(c),P=o(c,"BUTTON",{class:!0});var u=l(P);x=h(u,"Delete"),u.forEach(r),c.forEach(r),this.h()},h(){n(b,"class","svelte-1x1bio2"),n(P,"class","svelte-1x1bio2"),n($,"class","button-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,$,o),p($,b),p(b,k),p($,E),p($,P),p(P,x),I||(T=[g(b,"click",e[9]),g(P,"click",e[10])],I=!0)},p(e,t){1&t&&v(a,e[0])},d(e){e&&r(t),e&&r(i),e&&r($),I=!1,m(T)}}}function pe(e){let t,a,i,v,b,k,E,P,x,I,T,B,y,w,N,U,L,D,S;return{c(){t=s("div"),a=s("label"),i=d("Name"),b=u(),k=s("input"),P=u(),x=s("label"),I=d("Link"),B=u(),y=s("input"),N=u(),U=s("button"),L=d("Done"),this.h()},l(e){t=o(e,"DIV",{class:!0});var s=l(t);a=o(s,"LABEL",{for:!0});var n=l(a);i=h(n,"Name"),n.forEach(r),b=f(s),k=o(s,"INPUT",{id:!0,class:!0}),P=f(s),x=o(s,"LABEL",{for:!0});var c=l(x);I=h(c,"Link"),c.forEach(r),B=f(s),y=o(s,"INPUT",{id:!0,class:!0}),N=f(s),U=o(s,"BUTTON",{class:!0});var d=l(U);L=h(d,"Done"),d.forEach(r),s.forEach(r),this.h()},h(){n(a,"for",v="item-text-"+e[2]),n(k,"id",E="item-text-"+e[2]),n(k,"class","svelte-1x1bio2"),n(x,"for",T="item-href-"+e[2]),n(y,"id",w="item-href-"+e[2]),n(y,"class","svelte-1x1bio2"),n(U,"class","svelte-1x1bio2"),n(t,"class","edit-panel svelte-1x1bio2")},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,b),p(t,k),$(k,e[0]),p(t,P),p(t,x),p(x,I),p(t,B),p(t,y),$(y,e[1]),p(t,N),p(t,U),p(U,L),D||(S=[g(k,"input",e[6]),g(y,"input",e[7]),g(U,"click",e[8])],D=!0)},p(e,t){4&t&&v!==(v="item-text-"+e[2])&&n(a,"for",v),4&t&&E!==(E="item-text-"+e[2])&&n(k,"id",E),1&t&&k.value!==e[0]&&$(k,e[0]),4&t&&T!==(T="item-href-"+e[2])&&n(x,"for",T),4&t&&w!==(w="item-href-"+e[2])&&n(y,"id",w),2&t&&y.value!==e[1]&&$(y,e[1])},d(e){e&&r(t),D=!1,m(S)}}}function ge(e){let t;function a(e,t){return e[5]?pe:fe}let d=a(e),u=d(e);return{c(){t=s("div"),u.c(),this.h()},l(e){t=o(e,"DIV",{class:!0});var a=l(t);u.l(a),a.forEach(r),this.h()},h(){n(t,"class","item-container svelte-1x1bio2")},m(e,a){c(e,t,a),u.m(t,null)},p(e,[s]){d===(d=a(e))&&u?u.p(e,s):(u.d(1),u=d(e),u&&(u.c(),u.m(t,null)))},i:i,o:i,d(e){e&&r(t),u.d()}}}function ve(e,t,a){let s=!1,{text:o}=t,{href:l}=t,{index:r}=t,{handleDelete:n}=t,{handleUpdate:c}=t;return e.$$set=e=>{"text"in e&&a(0,o=e.text),"href"in e&&a(1,l=e.href),"index"in e&&a(2,r=e.index),"handleDelete"in e&&a(3,n=e.handleDelete),"handleUpdate"in e&&a(4,c=e.handleUpdate)},[o,l,r,n,c,s,function(){o=this.value,a(0,o)},function(){l=this.value,a(1,l)},()=>{a(5,s=!1),c()},()=>a(5,s=!0),()=>n(r)]}class me extends e{constructor(e){super(),t(this,e,ve,ge,a,{text:0,href:1,index:2,handleDelete:3,handleUpdate:4})}}function $e(e,t,a){const s=e.slice();return s[15]=t[a],s[16]=t,s[17]=a,s}function be(e,t){let a,s,o,l,n;function i(e){t[9].call(null,e,t[15])}function d(e){t[10].call(null,e,t[15])}let u={handleUpdate:t[3],handleDelete:t[5],index:t[17]};return void 0!==t[15].text&&(u.text=t[15].text),void 0!==t[15].href&&(u.href=t[15].href),s=new me({props:u}),D.push(()=>S(s,"text",i)),D.push(()=>S(s,"href",d)),{key:e,first:null,c(){a=b(),k(s.$$.fragment),this.h()},l(e){a=b(),E(s.$$.fragment,e),this.h()},h(){this.first=a},m(e,t){c(e,a,t),P(s,e,t),n=!0},p(e,a){t=e;const r={};1&a&&(r.index=t[17]),!o&&1&a&&(o=!0,r.text=t[15].text,x(()=>o=!1)),!l&&1&a&&(l=!0,r.href=t[15].href,x(()=>l=!1)),s.$set(r)},i(e){n||(I(s.$$.fragment,e),n=!0)},o(e){T(s.$$.fragment,e),n=!1},d(e){e&&r(a),B(s,e)}}}function ke(e){let t,a,i,v,b,k,E,P,x,B,L,D,S,O,V,A,j,H,M,q,R,z,C,F,W,G,K,J,Q=[],X=new Map,Y=e[0];const Z=e=>e[17];for(let t=0;t<Y.length;t+=1){let a=$e(e,Y,t),s=Z(a);X.set(s,Q[t]=be(s,a))}return{c(){t=s("p"),a=d("Logo"),i=u(),v=s("label"),b=d("Name"),k=u(),E=s("input"),P=u(),x=s("label"),B=d("Link"),L=u(),D=s("input"),S=u(),O=s("div"),V=s("label"),A=d("Image"),j=u(),H=s("input"),M=u(),q=s("p"),R=d("Links"),z=u();for(let e=0;e<Q.length;e+=1)Q[e].c();C=u(),F=s("button"),W=d("Add"),this.h()},l(e){t=o(e,"P",{});var s=l(t);a=h(s,"Logo"),s.forEach(r),i=f(e),v=o(e,"LABEL",{for:!0});var n=l(v);b=h(n,"Name"),n.forEach(r),k=f(e),E=o(e,"INPUT",{id:!0,type:!0}),P=f(e),x=o(e,"LABEL",{for:!0});var c=l(x);B=h(c,"Link"),c.forEach(r),L=f(e),D=o(e,"INPUT",{id:!0,type:!0}),S=f(e),O=o(e,"DIV",{class:!0});var d=l(O);V=o(d,"LABEL",{for:!0});var u=l(V);A=h(u,"Image"),u.forEach(r),j=f(d),H=o(d,"INPUT",{id:!0,type:!0,class:!0}),d.forEach(r),M=f(e),q=o(e,"P",{});var p=l(q);R=h(p,"Links"),p.forEach(r),z=f(e);for(let t=0;t<Q.length;t+=1)Q[t].l(e);C=f(e),F=o(e,"BUTTON",{});var g=l(F);W=h(g,"Add"),g.forEach(r),this.h()},h(){n(v,"for","logo-name-input"),n(E,"id","logo-name-input"),n(E,"type","text"),n(x,"for","logo-href"),n(D,"id","logo-href"),n(D,"type","text"),n(V,"for","logo-image-upload"),n(H,"id","logo-image-upload"),n(H,"type","file"),n(H,"class","svelte-1ss6k92"),n(O,"class","logo-image-upload-container")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),c(s,v,o),p(v,b),c(s,k,o),c(s,E,o),$(E,e[1]),c(s,P,o),c(s,x,o),p(x,B),c(s,L,o),c(s,D,o),$(D,e[2]),c(s,S,o),c(s,O,o),p(O,V),p(V,A),p(O,j),p(O,H),c(s,M,o),c(s,q,o),p(q,R),c(s,z,o);for(let e=0;e<Q.length;e+=1)Q[e].m(s,o);c(s,C,o),c(s,F,o),p(F,W),G=!0,K||(J=[g(E,"input",e[7]),g(E,"keyup",e[3]),g(D,"input",e[8]),g(D,"keyup",e[3]),g(F,"click",e[11])],K=!0)},p(e,[t]){if(2&t&&E.value!==e[1]&&$(E,e[1]),4&t&&D.value!==e[2]&&$(D,e[2]),41&t){const a=e[0];y(),Q=w(Q,t,Z,1,e,a,X,C.parentNode,N,be,C,$e),U()}},i(e){if(!G){for(let e=0;e<Y.length;e+=1)I(Q[e]);G=!0}},o(e){for(let e=0;e<Q.length;e+=1)T(Q[e]);G=!1},d(e){e&&r(t),e&&r(i),e&&r(v),e&&r(k),e&&r(E),e&&r(P),e&&r(x),e&&r(L),e&&r(D),e&&r(S),e&&r(O),e&&r(M),e&&r(q),e&&r(z);for(let t=0;t<Q.length;t+=1)Q[t].d(e);e&&r(C),e&&r(F),K=!1,m(J)}}}function Ee(e,t,a){let s;L(e,K,e=>a(13,s=e));let o,{elementId:l}=t,r=J(s,l),n=r?r.name:"",c=r?r.href:"";const i=()=>{Q(X({elementId:l,menuData:o,logoData:r}))},d=()=>{a(0,o=[...o,{text:"New Item",href:""}]),i()};return e.$$set=e=>{"elementId"in e&&a(6,l=e.elementId)},e.$$.update=()=>{8256&e.$$.dirty&&a(0,o=s.elementProps[l].menuData||[])},[o,n,c,()=>{r=Object.assign(Object.assign({},r),{name:n,href:c}),i()},d,e=>{a(0,o=o.filter((t,a)=>a!==e)),i()},l,function(){n=this.value,a(1,n)},function(){c=this.value,a(2,c)},function(e,t){t.text=e,a(0,o),a(13,s),a(6,l)},function(e,t){t.href=e,a(0,o),a(13,s),a(6,l)},()=>d()]}class Pe extends e{constructor(e){super(),t(this,e,Ee,ke,a,{elementId:6})}}function xe(e){let t,a,n,u;return{c(){t=s("button"),a=d("Select Parent")},l(e){t=o(e,"BUTTON",{});var s=l(t);a=h(s,"Select Parent"),s.forEach(r)},m(s,o){c(s,t,o),p(t,a),n||(u=g(t,"click",e[2]),n=!0)},p:i,i:i,o:i,d(e){e&&r(t),n=!1,u()}}}function Ie(e,t,a){let s;L(e,K,e=>a(0,s=e));const o=e=>{let t=Y(e),a=Z({store:e,blockId:t})||_({store:e,blockId:t});Q(ee({id:a}))};return[s,o,()=>o(s)]}class Te extends e{constructor(e){super(),t(this,e,Ie,xe,a,{})}}function Be(e){let t,a,i,b,x,y,w,N,U,L,D,S,O,V,A,j,H,M,q,R,z,C,F,W,G,K,J,Q,X,Y,Z,_=te(e[2])?"Split Vertically":"Split Horizontally";return b=new Te({}),{c(){t=s("h3"),a=d("Block Settings"),i=u(),k(b.$$.fragment),x=u(),y=s("button"),w=d(_),N=u(),U=s("button"),L=d("Delete Block"),D=u(),S=s("div"),O=s("label"),V=d("Background Image"),A=u(),j=s("input"),H=u(),M=s("label"),q=d("Background Color"),R=u(),z=s("div"),C=s("input"),F=u(),W=s("button"),G=d("Set"),K=u(),J=s("button"),Q=d("Reset Background"),this.h()},l(e){t=o(e,"H3",{});var s=l(t);a=h(s,"Block Settings"),s.forEach(r),i=f(e),E(b.$$.fragment,e),x=f(e),y=o(e,"BUTTON",{});var n=l(y);w=h(n,_),n.forEach(r),N=f(e),U=o(e,"BUTTON",{});var c=l(U);L=h(c,"Delete Block"),c.forEach(r),D=f(e),S=o(e,"DIV",{class:!0});var d=l(S);O=o(d,"LABEL",{for:!0,class:!0});var u=l(O);V=h(u,"Background Image"),u.forEach(r),A=f(d),j=o(d,"INPUT",{type:!0,id:!0,class:!0}),H=f(d),M=o(d,"LABEL",{for:!0,class:!0});var p=l(M);q=h(p,"Background Color"),p.forEach(r),R=f(d),z=o(d,"DIV",{class:!0});var g=l(z);C=o(g,"INPUT",{id:!0,type:!0,class:!0}),F=f(g),W=o(g,"BUTTON",{class:!0});var v=l(W);G=h(v,"Set"),v.forEach(r),g.forEach(r),d.forEach(r),K=f(e),J=o(e,"BUTTON",{class:!0});var m=l(J);Q=h(m,"Reset Background"),m.forEach(r),this.h()},h(){n(O,"for","background-image-upload"),n(O,"class","svelte-5hiwhc"),n(j,"type","file"),n(j,"id","background-image-upload"),n(j,"class","svelte-5hiwhc"),n(M,"for","background-color-picker"),n(M,"class","svelte-5hiwhc"),n(C,"id","background-color-picker"),n(C,"type","color"),n(C,"class","svelte-5hiwhc"),n(W,"class","color-picker-btn svelte-5hiwhc"),n(z,"class","color-setting-container svelte-5hiwhc"),n(S,"class","input-container"),n(J,"class","reset-background svelte-5hiwhc")},m(s,o){c(s,t,o),p(t,a),c(s,i,o),P(b,s,o),c(s,x,o),c(s,y,o),p(y,w),c(s,N,o),c(s,U,o),p(U,L),c(s,D,o),c(s,S,o),p(S,O),p(O,V),p(S,A),p(S,j),e[10](j),p(S,H),p(S,M),p(M,q),p(S,R),p(S,z),p(z,C),$(C,e[1]),p(z,F),p(z,W),p(W,G),c(s,K,o),c(s,J,o),p(J,Q),X=!0,Y||(Z=[g(y,"click",e[8]),g(U,"click",e[9]),g(j,"change",e[5]),g(C,"input",e[11]),g(W,"click",e[7]),g(J,"click",e[6])],Y=!0)},p(e,[t]){(!X||4&t)&&_!==(_=te(e[2])?"Split Vertically":"Split Horizontally")&&v(w,_),2&t&&$(C,e[1])},i(e){X||(I(b.$$.fragment,e),X=!0)},o(e){T(b.$$.fragment,e),X=!1},d(a){a&&r(t),a&&r(i),B(b,a),a&&r(x),a&&r(y),a&&r(N),a&&r(U),a&&r(D),a&&r(S),e[10](null),a&&r(K),a&&r(J),Y=!1,m(Z)}}}function ye(e,t,a){let s,o,l;L(e,K,e=>a(2,s=e));let r="#000000";const n=()=>{ae(l,s)},c=()=>{se(l)};return e.$$.update=()=>{4&e.$$.dirty&&(l=Y(s))},[o,r,s,n,c,()=>{if(o.files&&o.files[0]){let e=URL.createObjectURL(o.files[0]);console.log("tempUrl",e),Q(oe({blockId:l,url:e,reload:!0})),console.log("blockProps",s.blockProps[l]),M({file:o.files[0]}).then(e=>{Q(oe({blockId:l,url:e.data.data.url}))}).catch(()=>console.log("handleUpload: failed to upload to host"))}},()=>{Q(oe({blockId:l,reload:!0})),Q(le({blockId:l,color:""}))},()=>{Q(le({blockId:l,color:r}))},()=>n(),()=>c(),function(e){D[e?"unshift":"push"](()=>{o=e,a(0,o)})},function(){r=this.value,a(1,r)}]}class we extends e{constructor(e){super(),t(this,e,ye,Be,a,{})}}function Ne(e){let t,a,i,$,b,k,E,P,x,B,y,w,N,U,L,D,S,j,H,M,q,R,z,C,F,W,G,K,J,Q="Status: "+(e[2].saved?"Saved":"Modified"),X=e[2].pageProps.editingLayout?"Preview Page":"Edit Page",Y=e[2].published?"Unpublish Page":"Publish Page",Z="Build Site",_=e[2].pageProps.editingLayout?"Preview":"Edit";const ee=e[8].default,te=O(ee,e,e[7],null);return{c(){t=s("div"),a=s("div"),i=d(Q),$=u(),b=s("button"),k=d("x"),E=u(),P=s("button"),x=d(X),B=u(),y=s("button"),w=d(Y),N=u(),U=s("button"),L=d(Z),D=u(),S=s("div"),j=d("Build Status: "),H=d(e[1]),M=u(),te&&te.c(),q=u(),R=s("button"),z=d("Show Toolbar"),C=u(),F=s("button"),W=d(_),this.h()},l(s){t=o(s,"DIV",{id:!0,class:!0});var n=l(t);a=o(n,"DIV",{class:!0});var c=l(a);i=h(c,Q),c.forEach(r),$=f(n),b=o(n,"BUTTON",{class:!0});var d=l(b);k=h(d,"x"),d.forEach(r),E=f(n),P=o(n,"BUTTON",{class:!0});var u=l(P);x=h(u,X),u.forEach(r),B=f(n),y=o(n,"BUTTON",{class:!0});var p=l(y);w=h(p,Y),p.forEach(r),N=f(n),U=o(n,"BUTTON",{disabled:!0,class:!0});var g=l(U);L=h(g,Z),g.forEach(r),D=f(n),S=o(n,"DIV",{});var v=l(S);j=h(v,"Build Status: "),H=h(v,e[1]),v.forEach(r),M=f(n),te&&te.l(n),n.forEach(r),q=f(s),R=o(s,"BUTTON",{class:!0});var m=l(R);z=h(m,"Show Toolbar"),m.forEach(r),C=f(s),F=o(s,"BUTTON",{class:!0});var I=l(F);W=h(I,_),I.forEach(r),this.h()},h(){n(a,"class","status svelte-1taoa0b"),n(b,"class","close-toolbar-btn svelte-1taoa0b"),n(P,"class","svelte-1taoa0b"),n(y,"class","svelte-1taoa0b"),U.disabled=e[0],n(U,"class","svelte-1taoa0b"),n(t,"id","toolbar"),n(t,"class","svelte-1taoa0b"),V(t,"hidden",!e[2].pageProps.showToolbar),n(R,"class","toolbar-toggle svelte-1taoa0b"),V(R,"hidden",re(e[2])),n(F,"class","preview-btn svelte-1taoa0b"),V(F,"hidden",re(e[2]))},m(s,o){c(s,t,o),p(t,a),p(a,i),p(t,$),p(t,b),p(b,k),p(t,E),p(t,P),p(P,x),p(t,B),p(t,y),p(y,w),p(t,N),p(t,U),p(U,L),p(t,D),p(t,S),p(S,j),p(S,H),p(t,M),te&&te.m(t,null),c(s,q,o),c(s,R,o),p(R,z),c(s,C,o),c(s,F,o),p(F,W),G=!0,K||(J=[g(b,"click",e[4]),g(P,"click",e[3]),g(y,"click",e[5]),g(U,"click",e[6]),g(R,"click",e[4]),g(F,"click",e[3])],K=!0)},p(e,[a]){(!G||4&a)&&Q!==(Q="Status: "+(e[2].saved?"Saved":"Modified"))&&v(i,Q),(!G||4&a)&&X!==(X=e[2].pageProps.editingLayout?"Preview Page":"Edit Page")&&v(x,X),(!G||4&a)&&Y!==(Y=e[2].published?"Unpublish Page":"Publish Page")&&v(w,Y),(!G||1&a)&&(U.disabled=e[0]),(!G||2&a)&&v(H,e[1]),te&&te.p&&128&a&&A(te,ee,e,e[7],a,null,null),4&a&&V(t,"hidden",!e[2].pageProps.showToolbar),4&a&&V(R,"hidden",re(e[2])),(!G||4&a)&&_!==(_=e[2].pageProps.editingLayout?"Preview":"Edit")&&v(W,_),4&a&&V(F,"hidden",re(e[2]))},i(e){G||(I(te,e),G=!0)},o(e){T(te,e),G=!1},d(e){e&&r(t),te&&te.d(e),e&&r(q),e&&r(R),e&&r(C),e&&r(F),K=!1,m(J)}}}function Ue(e,t,a){let s;L(e,K,e=>a(2,s=e));let{$$slots:o={},$$scope:l}=t,r=!1,n="Idle";return e.$$set=e=>{"$$scope"in e&&a(7,l=e.$$scope)},[r,n,s,()=>{s.pageProps.editingLayout&&Q(ee({id:""})),Q(ne()),Q(ce())},()=>Q(ie()),()=>Q(de()),()=>{a(0,r=!0),a(1,n="Building..."),q().then(()=>{a(1,n="Success"),a(0,r=!1)}).catch(e=>{console.log("Build error",e),a(1,n="Failed"),a(0,r=!1)})},l,o]}class Le extends e{constructor(e){super(),t(this,e,Ue,Ne,a,{})}}function De(e){let t;return{c(){t=d("Select a block to change its settings")},l(e){t=h(e,"Select a block to change its settings")},m(e,a){c(e,t,a)},p:i,i:i,o:i,d(e){e&&r(t)}}}function Se(e){let t,a,i,g,v,m,$,x="menu"===e[2](e[0]).type;t=new we({});let w=x&&Oe(e);return{c(){k(t.$$.fragment),a=u(),i=s("h3"),g=d("Element Settings"),v=u(),w&&w.c(),m=b(),this.h()},l(e){E(t.$$.fragment,e),a=f(e),i=o(e,"H3",{class:!0});var s=l(i);g=h(s,"Element Settings"),s.forEach(r),v=f(e),w&&w.l(e),m=b(),this.h()},h(){n(i,"class","element-title svelte-1to17tn")},m(e,s){P(t,e,s),c(e,a,s),c(e,i,s),p(i,g),c(e,v,s),w&&w.m(e,s),c(e,m,s),$=!0},p(e,t){1&t&&(x="menu"===e[2](e[0]).type),x?w?(w.p(e,t),1&t&&I(w,1)):(w=Oe(e),w.c(),I(w,1),w.m(m.parentNode,m)):w&&(y(),T(w,1,1,()=>{w=null}),U())},i(e){$||(I(t.$$.fragment,e),I(w),$=!0)},o(e){T(t.$$.fragment,e),T(w),$=!1},d(e){B(t,e),e&&r(a),e&&r(i),e&&r(v),w&&w.d(e),e&&r(m)}}}function Oe(e){let t,a;return t=new Pe({props:{elementId:e[1](e[0])}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,a){const s={};1&a&&(s.elementId=e[1](e[0])),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){B(t,e)}}}function Ve(e){let t,a,s,o,l;const n=[Se,De],i=[];function d(e,a){return 1&a&&(t=!!e[2](e[0])),t?0:1}return a=d(e,-1),s=i[a]=n[a](e),{c(){s.c(),o=b()},l(e){s.l(e),o=b()},m(e,t){i[a].m(e,t),c(e,o,t),l=!0},p(e,t){let l=a;a=d(e,t),a===l?i[a].p(e,t):(y(),T(i[l],1,1,()=>{i[l]=null}),U(),s=i[a],s||(s=i[a]=n[a](e),s.c()),I(s,1),s.m(o.parentNode,o))},i(e){l||(I(s),l=!0)},o(e){T(s),l=!1},d(e){i[a].d(e),e&&r(o)}}}function Ae(e){let t,a;return t=new Le({props:{$$slots:{default:[Ve]},$$scope:{ctx:e}}}),{c(){k(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,s){P(t,e,s),a=!0},p(e,[a]){const s={};9&a&&(s.$$scope={dirty:a,ctx:e}),t.$set(s)},i(e){a||(I(t.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),a=!1},d(e){B(t,e)}}}function je(e,t,a){let s;L(e,K,e=>a(0,s=e));const o=e=>{let t=(e.pageProps.focusedBlock||{}).id;if(e.blockProps[t])return(e.blockProps[t].elements||[void 0])[0]};return[s,o,e=>{let t=o(e);if(t)return e.elementProps[t]}]}class He extends e{constructor(e){super(),t(this,e,je,Ae,a,{})}}function Me(e){let t,a,i,d,h,v,m,$,b;return d=new ue({}),v=new He({}),{c(){t=s("main"),a=s("div"),i=s("div"),k(d.$$.fragment),h=u(),k(v.$$.fragment),this.h()},l(e){t=o(e,"MAIN",{class:!0});var s=l(t);a=o(s,"DIV",{class:!0});var n=l(a);i=o(n,"DIV",{class:!0});var c=l(i);E(d.$$.fragment,c),c.forEach(r),n.forEach(r),h=f(s),E(v.$$.fragment,s),s.forEach(r),this.h()},h(){n(i,"class","block svelte-52p31m"),n(a,"class","page svelte-52p31m"),V(a,"makeWayForToolbar",re(e[1])),n(t,"class","svelte-52p31m"),V(t,"hidden",e[0])},m(s,o){c(s,t,o),p(t,a),p(a,i),P(d,i,null),p(t,h),P(v,t,null),m=!0,$||(b=g(a,"click",e[6]),$=!0)},p(e,[s]){2&s&&V(a,"makeWayForToolbar",re(e[1])),1&s&&V(t,"hidden",e[0])},i(e){m||(I(d.$$.fragment,e),I(v.$$.fragment,e),m=!0)},o(e){T(d.$$.fragment,e),T(v.$$.fragment,e),m=!1},d(e){e&&r(t),B(d),B(v),$=!1,b()}}}var qe=function(e,t,a,s){return new(a||(a=Promise))((function(o,l){function r(e){try{c(s.next(e))}catch(e){l(e)}}function n(e){try{c(s.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,n)}c((s=s.apply(e,t||[])).next())}))};function Re(e,t){return qe(this,void 0,void 0,(function*(){try{const a=e.params.pageId,s=R(a);if(!t.userId)return void this.redirect(302,z(a));const o=yield this.fetch(s),l=yield o.json();return l?"true"===e.query.create?void this.redirect(302,C(a)):(K.set(l),{storePreloaded:l,pageId:a,create:!1,csrf:t.csrf}):"true"===e.query.create?{pageId:a,create:!0,storePreloaded:void 0,csrf:t.csrf}:void this.error(404,"Page not found")}catch(e){this.error(500,e)}}))}function ze(e,t,a){let s;L(e,K,e=>a(1,s=e));let{storePreloaded:o}=t,{pageId:l}=t,{create:r}=t,{csrf:n}=t,c=!0;F(n),o&&j(K,s=o,s);const i=()=>{G(l,s).then(()=>{console.log("saved"),Q(he())}).catch(()=>console.log("save error:"))},d=()=>{i(),setInterval(()=>{s.saved||i()},5e3),window.onbeforeunload=()=>{s.saved||(alert("Page not saved, confirm to leave?"),i())}},u=()=>{W(l).then(e=>{e.data?(console.log("Page already exist, redirecting"),window.location.assign(window.location.href.replace("?create=true",""))):d()}).catch(e=>{console.log("get Page error retrying in 5s",e),setTimeout(u,5e3)})};H(()=>{r?u():d(),a(0,c=!1)});return e.$$set=e=>{"storePreloaded"in e&&a(2,o=e.storePreloaded),"pageId"in e&&a(3,l=e.pageId),"create"in e&&a(4,r=e.create),"csrf"in e&&a(5,n=e.csrf)},[c,s,o,l,r,n,()=>Q(ee({id:""}))]}export default class extends e{constructor(e){super(),t(this,e,ze,Me,a,{storePreloaded:2,pageId:3,create:4,csrf:5})}}export{Re as preload};
