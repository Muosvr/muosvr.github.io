import{S as e,i as a,s as t,e as r,c as s,a as n,d as l,b as c,f as o,n as h,t as i,g as u,h as f,j as p,k as d,l as m,m as g,o as v,p as $,q as E,r as w,u as I,v as y,w as A,x as L,y as j}from"./client.8b5d2d74.js";import{l as P,L as x,P as b}from"./index.ef1483ad.js";import{v as N}from"./v4.96b22442.js";function S(e){let a,t,m,g,v,$,E,w;return{c(){a=r("a"),t=i("Register"),m=u(),g=r("span"),v=i("|"),$=u(),E=r("a"),w=i("Login"),this.h()},l(e){a=s(e,"A",{href:!0});var r=n(a);t=f(r,"Register"),r.forEach(l),m=p(e),g=s(e,"SPAN",{});var c=n(g);v=f(c,"|"),c.forEach(l),$=p(e),E=s(e,"A",{href:!0});var o=n(E);w=f(o,"Login"),o.forEach(l),this.h()},h(){c(a,"href","/auth/register"),c(E,"href","/auth/login")},m(e,r){o(e,a,r),d(a,t),o(e,m,r),o(e,g,r),d(g,v),o(e,$,r),o(e,E,r),d(E,w)},p:h,d(e){e&&l(a),e&&l(m),e&&l(g),e&&l($),e&&l(E)}}}function k(e){let a,t,h,v,$,E,w,I,y,A;return{c(){a=r("span"),t=i(e[0]),h=u(),v=r("span"),$=i("|"),E=u(),w=r("span"),I=i("Logout"),this.h()},l(r){a=s(r,"SPAN",{class:!0});var c=n(a);t=f(c,e[0]),c.forEach(l),h=p(r),v=s(r,"SPAN",{});var o=n(v);$=f(o,"|"),o.forEach(l),E=p(r),w=s(r,"SPAN",{class:!0});var i=n(w);I=f(i,"Logout"),i.forEach(l),this.h()},h(){c(a,"class","username"),c(w,"class","logout svelte-4wajjh")},m(r,s){o(r,a,s),d(a,t),o(r,h,s),o(r,v,s),d(v,$),o(r,E,s),o(r,w,s),d(w,I),y||(A=m(w,"click",e[1]),y=!0)},p(e,a){1&a&&g(t,e[0])},d(e){e&&l(a),e&&l(h),e&&l(v),e&&l(E),e&&l(w),y=!1,A()}}}function M(e){let a;function t(e,a){return e[0]?k:S}let i=t(e),u=i(e);return{c(){a=r("div"),u.c(),this.h()},l(e){a=s(e,"DIV",{class:!0});var t=n(a);u.l(t),t.forEach(l),this.h()},h(){c(a,"class","user-menu svelte-4wajjh")},m(e,t){o(e,a,t),u.m(a,null)},p(e,[r]){i===(i=t(e))&&u?u.p(e,r):(u.d(1),u=i(e),u&&(u.c(),u.m(a,null)))},i:h,o:h,d(e){e&&l(a),u.d()}}}function R(e,a,t){let{username:r}=a;return e.$$set=e=>{"username"in e&&t(0,r=e.username)},[r,()=>{P().then(()=>window.location.reload()).catch(e=>console.log("Logout error"))}]}class _ extends e{constructor(e){super(),a(this,e,R,M,t,{username:0})}}function U(e,a,t){const r=e.slice();return r[6]=a[t],r}function q(e){let a,t,h;return{c(){a=r("a"),t=i("create"),this.h()},l(e){a=s(e,"A",{href:!0});var r=n(a);t=f(r,"create"),r.forEach(l),this.h()},h(){c(a,"href",h=e[3](e[2]))},m(e,r){o(e,a,r),d(a,t)},p(e,t){4&t&&h!==(h=e[3](e[2]))&&c(a,"href",h)},d(e){e&&l(a)}}}function B(e,a){let t,h,m,v,$,E=`${a[6].pageId.replace(O,"").replace("_"," ")} ${a[6].published?"":"(draft)"}`;return{key:e,first:null,c(){t=r("li"),h=r("a"),m=i(E),$=u(),this.h()},l(e){t=s(e,"LI",{});var a=n(t);h=s(a,"A",{href:!0});var r=n(h);m=f(r,E),r.forEach(l),$=p(a),a.forEach(l),this.h()},h(){c(h,"href",v="/"+a[6].pageId),this.first=t},m(e,a){o(e,t,a),d(t,h),d(h,m),d(t,$)},p(e,a){1&a&&E!==(E=`${e[6].pageId.replace(O,"").replace("_"," ")} ${e[6].published?"":"(draft)"}`)&&g(m,E),1&a&&v!==(v="/"+e[6].pageId)&&c(h,"href",v)},d(e){e&&l(t)}}}function D(e){let a,t,h,P,x,b,N,S,k,M,R,D,F,H,O,T,V,z=e[1]+"'s Pages",C=[],G=new Map;x=new _({props:{username:e[1]}});let J=e[2]&&q(e),K=e[0]||[];const Q=e=>e[6].pageId;for(let a=0;a<K.length;a+=1){let t=U(e,K,a),r=Q(t);G.set(r,C[a]=B(r,t))}return{c(){a=r("main"),t=r("h1"),h=i(z),P=u(),v(x.$$.fragment),b=u(),N=r("form"),S=r("label"),k=i("Enter a page title"),M=u(),R=r("input"),D=u(),J&&J.c(),F=u(),H=r("ul");for(let e=0;e<C.length;e+=1)C[e].c();this.h()},l(e){a=s(e,"MAIN",{class:!0});var r=n(a);t=s(r,"H1",{class:!0});var c=n(t);h=f(c,z),c.forEach(l),P=p(r),$(x.$$.fragment,r),b=p(r),N=s(r,"FORM",{});var o=n(N);S=s(o,"LABEL",{for:!0});var i=n(S);k=f(i,"Enter a page title"),i.forEach(l),M=p(o),R=s(o,"INPUT",{id:!0}),D=p(o),J&&J.l(o),o.forEach(l),F=p(r),H=s(r,"UL",{});var u=n(H);for(let e=0;e<C.length;e+=1)C[e].l(u);u.forEach(l),r.forEach(l),this.h()},h(){c(t,"class","page-title svelte-1whrfpy"),c(S,"for","page-name-input"),c(R,"id","page-name-input"),c(a,"class","svelte-1whrfpy")},m(r,s){o(r,a,s),d(a,t),d(t,h),d(a,P),E(x,a,null),d(a,b),d(a,N),d(N,S),d(S,k),d(N,M),d(N,R),w(R,e[2]),d(N,D),J&&J.m(N,null),d(a,F),d(a,H);for(let e=0;e<C.length;e+=1)C[e].m(H,null);O=!0,T||(V=m(R,"input",e[4]),T=!0)},p(e,[a]){(!O||2&a)&&z!==(z=e[1]+"'s Pages")&&g(h,z);const t={};if(2&a&&(t.username=e[1]),x.$set(t),4&a&&R.value!==e[2]&&w(R,e[2]),e[2]?J?J.p(e,a):(J=q(e),J.c(),J.m(N,null)):J&&(J.d(1),J=null),1&a){const t=e[0]||[];C=I(C,a,Q,1,e,t,G,H,j,B,null,U)}},i(e){O||(y(x.$$.fragment,e),O=!0)},o(e){A(x.$$.fragment,e),O=!1},d(e){e&&l(a),L(x),J&&J.d();for(let e=0;e<C.length;e+=1)C[e].d();T=!1,V()}}}var F=function(e,a,t,r){return new(t||(t=Promise))((function(s,n){function l(e){try{o(r.next(e))}catch(e){n(e)}}function c(e){try{o(r.throw(e))}catch(e){n(e)}}function o(e){var a;e.done?s(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,c)}o((r=r.apply(e,a||[])).next())}))};function H(e,a){return F(this,void 0,void 0,(function*(){try{a.userId||this.redirect(302,x);let e=b;const t=yield this.fetch(e);return{pages:yield t.json(),userId:a.userId,username:a.username}}catch(e){this.error(500,e)}}))}let O=/(-[\w]+)+$/g;function T(e,a,t){let r,{pages:s}=a,{username:n}=a,l=N();return e.$$set=e=>{"pages"in e&&t(0,s=e.pages),"username"in e&&t(1,n=e.username)},[s,n,r,e=>`/${e.replace(" ","_")}-${l}/edit/?create=true`,function(){r=this.value,t(2,r)}]}export default class extends e{constructor(e){super(),a(this,e,T,D,t,{pages:0,username:1})}}export{H as preload};
